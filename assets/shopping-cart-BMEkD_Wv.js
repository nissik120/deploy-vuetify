import{c as tt,o as et,a as nt}from"./cartstore-CRbNSkFL.js";import{p as at}from"./productstore-BgcDDVwz.js";import{b as S,a as ot,_ as st}from"./VCard-DzfsfQ-5.js";import{r as I,M as lt,e as x,o as c,q as f,z as s,l as v,ad as k,i as a,n,x as b,F,v as ut,y as i}from"./index-BoiogL3_.js";import{h as $,f as _,V as q,g as h}from"./VRow-i-kUYO6k.js";import{g as m,h as D,_ as rt}from"./AppNav-DMyNdu4P.js";const it={class:"ma-2"},ct={key:0},pt={key:1},dt={class:"d-flex py-2 justify-end"},mt={class:"mb-1"},_t={class:"grey--text mb-0"},ft={class:"mx-2"},vt={class:"mx-4"},gt={class:"font-weight-black"},Ct={__name:"CartSection",setup(T){const r=tt(),g=at(),l=I(null),N=I([]),p=I([]);lt(()=>{et(nt,e=>{e?(l.value=e,r.fetchCartItems(e)):(l.value=null,N.value=[])})});const A=async(e,t)=>{await r.addToCart(e,t)},B=async(e,t)=>{await r.decreaseQuantity(e,t)},R=async(e,t)=>{await r.removeItemFromCart(e,t)},E=async e=>{await r.clearCart(e)},z=x(()=>r.getCartCount),C=x(()=>(j(),p.value)),d=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e),j=()=>{const e=r.getCartList(),t=g.retrieveProductList();let o=[],u=[];t.then(Z=>{u=Z,e.forEach(y=>{let L=u.find(U=>U.priceId==y.priceId);y.name=L.name,y.unit_price=L.priceInfo.unit_amount/100,o.push(y)}),p.value=o})};function M(e){let t=p.value.find(o=>o.priceId==e);return t.quantity*t.unit_price}function O(e){let t=M(e);return d(t)}const Q=()=>p.value.reduce((e,t)=>e+t.unit_price*t.quantity,0),H=x(()=>{let e=Q();return d(e)});function V(){return p.value.reduce((o,u)=>o+u.unit_price*u.quantity,0)*.1}function G(){let e=V();return d(e)}function w(){return p.value.reduce((o,u)=>o+u.unit_price*u.quantity,0)*.16}function J(){let e=w();return d(e)}function P(){return 10}function K(){let e=P();return d(e)}function W(){return p.value.reduce((t,o)=>t+o.unit_price*o.quantity,0)+P()+w()-V()}const X=x(()=>{let e=W();return d(e)});async function Y(e){await r.executeCheckout(e)}return(e,t)=>(c(),f("div",it,[t[9]||(t[9]=s("div",{class:"py-6"},[s("h1",null,"Shopping Cart")],-1)),l.value?(c(),f("div",pt,[s("div",dt,[a(_,{color:"warning",onClick:t[0]||(t[0]=o=>E(l.value))},{default:n(()=>[a($,null,{default:n(()=>t[2]||(t[2]=[b("mdi-cart-remove")])),_:1})]),_:1})]),C.value.length>0?(c(),v(S,{key:0,class:"mx-auto"},{default:n(()=>[(c(!0),f(F,null,ut(C.value,o=>(c(),v(m,{class:"w-100"},{default:n(()=>[a(q,{class:"pa-2"},{default:n(()=>[a(h,{cols:"3"},{default:n(()=>[a(ot,{src:"https://picsum.photos/100",alt:"Product Image",width:100,"aspect-ratio":"1",cover:""})]),_:1}),a(h,{cols:"9"},{default:n(()=>[a(q,null,{default:n(()=>[a(h,{cols:"12"},{default:n(()=>[s("h4",mt,i(o.name),1),s("p",_t,i(d(o.unit_price)),1)]),_:2},1024),a(h,{cols:"12",class:"d-flex align-center justify-end"},{default:n(()=>[a(_,{icon:"mdi-minus",onClick:u=>B(l.value,o.priceId),size:"xx-small"},null,8,["onClick"]),s("span",ft,i(o.quantity),1),a(_,{icon:"mdi-plus",onClick:u=>A(l.value,o.priceId),size:"xx-small"},null,8,["onClick"]),s("div",vt,[s("span",null,i(O(o.priceId)),1)]),a(_,{color:"warning",onClick:u=>R(l.value,o.priceId)},{default:n(()=>[a($,null,{default:n(()=>t[3]||(t[3]=[b("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(D)]),_:2},1024))),256))]),_:1})):k("",!0),C.value.length>0?(c(),v(S,{key:1,class:"my-2 mx-auto"},{actions:n(()=>[a(_,{"append-icon":"mdi-chevron-right",onClick:t[1]||(t[1]=o=>Y(l.value)),color:"red-lighten-2",text:"Checkout",variant:"outlined",block:""})]),default:n(()=>[a(m,null,{title:n(()=>t[4]||(t[4]=[s("span",null,"Subtotal",-1)])),append:n(()=>[s("span",null,i(H.value),1)]),_:1}),a(m,null,{title:n(()=>t[5]||(t[5]=[s("span",null,"Discount",-1)])),append:n(()=>[s("span",null,"- "+i(G()),1)]),_:1}),a(m,null,{title:n(()=>t[6]||(t[6]=[s("span",null,"Shipping & Handling",-1)])),append:n(()=>[s("span",null,i(K()),1)]),_:1}),a(m,null,{title:n(()=>t[7]||(t[7]=[s("span",null,"Tax",-1)])),append:n(()=>[s("span",null,i(J()),1)]),_:1}),a(D),a(m,null,{title:n(()=>[t[8]||(t[8]=s("span",{class:"font-weight-black"},"Subtotal",-1)),b(" - "+i(z.value)+" Item(s) ",1)]),append:n(()=>[s("span",gt,i(X.value),1)]),_:1})]),_:1})):k("",!0)])):(c(),f("div",ct,[C.value.length==0?(c(),v(S,{key:0,class:"my-2 mx-auto",subtitle:"Please log in to access your cart....",title:"Oh! Oh!"})):k("",!0)]))]))}},yt={};function xt(T,r){const g=rt,l=Ct;return c(),f(F,null,[a(g),a(l)],64)}const ht=st(yt,[["render",xt]]),wt={__name:"shopping-cart",setup(T){return(r,g)=>{const l=ht;return c(),v(l)}}};export{wt as default};
