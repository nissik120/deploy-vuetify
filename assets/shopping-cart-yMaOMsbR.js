import{e as tt,o as et,f as nt}from"./cartstore-D1jmQpVU.js";import{p as at}from"./productstore-BgJsmcHv.js";import{b as S,a as ot,_ as st}from"./VCard-CbBR3Asr.js";import{r as I,ab as lt,n as x,z as c,C as f,H as s,A as v,aN as k,v as a,B as n,L as D,E as b,V as _,F as q,D as ut,G as i}from"./index-BtwZ7pdx.js";import{h as m,g as $,_ as rt}from"./AppNav-CCCFOkHA.js";import{V as N,a as h}from"./VRow-q-paJWpp.js";const it={class:"ma-2"},ct={key:0},pt={key:1},dt={class:"d-flex py-2 justify-end"},mt={class:"mb-1"},_t={class:"grey--text mb-0"},ft={class:"mx-2"},vt={class:"mx-4"},Ct={class:"font-weight-black"},gt={__name:"CartSection",setup(T){const r=tt(),C=at(),l=I(null),A=I([]),p=I([]);lt(()=>{et(nt,e=>{e?(l.value=e,r.fetchCartItems(e)):(l.value=null,A.value=[])})});const B=async(e,t)=>{await r.addToCart(e,t)},F=async(e,t)=>{await r.decreaseQuantity(e,t)},E=async(e,t)=>{await r.removeItemFromCart(e,t)},R=async e=>{await r.clearCart(e)},z=x(()=>r.getCartCount),g=x(()=>(j(),p.value)),d=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e),j=()=>{const e=r.getCartList(),t=C.retrieveProductList();let o=[],u=[];t.then(Z=>{u=Z,e.forEach(y=>{let L=u.find(U=>U.priceId==y.priceId);y.name=L.name,y.unit_price=L.priceInfo.unit_amount/100,o.push(y)}),p.value=o})};function H(e){let t=p.value.find(o=>o.priceId==e);return t.quantity*t.unit_price}function O(e){let t=H(e);return d(t)}const Q=()=>p.value.reduce((e,t)=>e+t.unit_price*t.quantity,0),G=x(()=>{let e=Q();return d(e)});function V(){return p.value.reduce((o,u)=>o+u.unit_price*u.quantity,0)*.1}function M(){let e=V();return d(e)}function w(){return p.value.reduce((o,u)=>o+u.unit_price*u.quantity,0)*.16}function J(){let e=w();return d(e)}function P(){return 10}function K(){let e=P();return d(e)}function W(){return p.value.reduce((t,o)=>t+o.unit_price*o.quantity,0)+P()+w()-V()}const X=x(()=>{let e=W();return d(e)});async function Y(e){await r.executeCheckout(e)}return(e,t)=>(c(),f("div",it,[t[9]||(t[9]=s("div",{class:"py-6"},[s("h1",null,"Shopping Cart")],-1)),l.value?(c(),f("div",pt,[s("div",dt,[a(_,{color:"warning",onClick:t[0]||(t[0]=o=>R(l.value))},{default:n(()=>[a(D,null,{default:n(()=>t[2]||(t[2]=[b("mdi-cart-remove")])),_:1})]),_:1})]),g.value.length>0?(c(),v(S,{key:0,class:"mx-auto"},{default:n(()=>[(c(!0),f(q,null,ut(g.value,o=>(c(),v(m,{class:"w-100"},{default:n(()=>[a(N,{class:"pa-2"},{default:n(()=>[a(h,{cols:"3"},{default:n(()=>[a(ot,{src:"https://picsum.photos/100",alt:"Product Image",width:100,"aspect-ratio":"1",cover:""})]),_:1}),a(h,{cols:"9"},{default:n(()=>[a(N,null,{default:n(()=>[a(h,{cols:"12"},{default:n(()=>[s("h4",mt,i(o.name),1),s("p",_t,i(d(o.unit_price)),1)]),_:2},1024),a(h,{cols:"12",class:"d-flex align-center justify-end"},{default:n(()=>[a(_,{icon:"mdi-minus",onClick:u=>F(l.value,o.priceId),size:"xx-small"},null,8,["onClick"]),s("span",ft,i(o.quantity),1),a(_,{icon:"mdi-plus",onClick:u=>B(l.value,o.priceId),size:"xx-small"},null,8,["onClick"]),s("div",vt,[s("span",null,i(O(o.priceId)),1)]),a(_,{color:"warning",onClick:u=>E(l.value,o.priceId)},{default:n(()=>[a(D,null,{default:n(()=>t[3]||(t[3]=[b("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a($)]),_:2},1024))),256))]),_:1})):k("",!0),g.value.length>0?(c(),v(S,{key:1,class:"my-2 mx-auto"},{actions:n(()=>[a(_,{"append-icon":"mdi-chevron-right",onClick:t[1]||(t[1]=o=>Y(l.value)),color:"red-lighten-2",text:"Checkout",variant:"outlined",block:""})]),default:n(()=>[a(m,null,{title:n(()=>t[4]||(t[4]=[s("span",null,"Subtotal",-1)])),append:n(()=>[s("span",null,i(G.value),1)]),_:1}),a(m,null,{title:n(()=>t[5]||(t[5]=[s("span",null,"Discount",-1)])),append:n(()=>[s("span",null,"- "+i(M()),1)]),_:1}),a(m,null,{title:n(()=>t[6]||(t[6]=[s("span",null,"Shipping & Handling",-1)])),append:n(()=>[s("span",null,i(K()),1)]),_:1}),a(m,null,{title:n(()=>t[7]||(t[7]=[s("span",null,"Tax",-1)])),append:n(()=>[s("span",null,i(J()),1)]),_:1}),a($),a(m,null,{title:n(()=>[t[8]||(t[8]=s("span",{class:"font-weight-black"},"Subtotal",-1)),b(" - "+i(z.value)+" Item(s) ",1)]),append:n(()=>[s("span",Ct,i(X.value),1)]),_:1})]),_:1})):k("",!0)])):(c(),f("div",ct,[g.value.length==0?(c(),v(S,{key:0,class:"my-2 mx-auto",subtitle:"Please log in to access your cart....",title:"Oh! Oh!"})):k("",!0)]))]))}},yt={};function xt(T,r){const C=rt,l=gt;return c(),f(q,null,[a(C),a(l)],64)}const ht=st(yt,[["render",xt]]),wt={__name:"shopping-cart",setup(T){return(r,C)=>{const l=ht;return c(),v(l)}}};export{wt as default};
